# Serenity BDD 5.3.2 Release Notes

**Fix `NoClassDefFoundError: ParentRunner` When Using Cucumber with JUnit 5**

This patch release fixes a `NoClassDefFoundError` that occurred when running Cucumber scenarios with JUnit 5 (without JUnit 4 on the classpath). The error was triggered by Serenity's Cucumber reporter plugins referencing a class that extends JUnit 4's `ParentRunner`.

## Bug Fix

### Cucumber Reporters No Longer Require JUnit 4 at Runtime

Previously, `SerenityReporterParallel`, `SerenityReporter`, and `StoredFeatureFile` called `CucumberWithSerenity.currentRuntimeOptions()` to access Cucumber's runtime tag filters and feature paths. Because `CucumberWithSerenity` extends `CucumberSerenityBaseRunner` which extends JUnit 4's `ParentRunner`, merely referencing the class triggered the JVM to load the entire JUnit 4 class hierarchy. This caused a `NoClassDefFoundError` for users who only have JUnit 5 + Cucumber on their classpath:

```
java.lang.NoClassDefFoundError: org/junit/runners/ParentRunner
    at ...SerenityReporterParallel.getCucumberRuntimeTags(SerenityReporterParallel.java:622)
    at ...SerenityReporterParallel.testRunHasFilterTags(SerenityReporterParallel.java:617)
    at ...SerenityReporterParallel.examplesAreNotExcludedByTags(SerenityReporterParallel.java:603)
    ...
Caused by: java.lang.ClassNotFoundException: org.junit.runners.ParentRunner
```

**Root cause:** The `RuntimeOptions` storage (a `ThreadLocal` and a static field) lived inside `CucumberSerenityBaseRunner`, a class that extends JUnit 4's `ParentRunner`. The storage itself has no dependency on JUnit 4 — it just happened to be declared in the wrong class.

**Fix:** A new standalone class `CucumberRuntimeOptions` in the `net.serenitybdd.cucumber` package now holds the runtime options storage. All callers (`SerenityReporterParallel`, `SerenityReporter`, `StoredFeatureFile`, and `Main`) now reference this new class instead of `CucumberWithSerenity`. The old methods on `CucumberSerenityBaseRunner` have been preserved as deprecated delegates for backward compatibility.

### Affected Components

| File | Change |
|------|--------|
| `CucumberRuntimeOptions` | **New** — standalone RuntimeOptions storage with no JUnit 4 dependency |
| `CucumberSerenityBaseRunner` | Delegates to `CucumberRuntimeOptions`; methods marked `@Deprecated` |
| `SerenityReporterParallel` | Uses `CucumberRuntimeOptions` instead of `CucumberWithSerenity` |
| `SerenityReporter` | Uses `CucumberRuntimeOptions` instead of `CucumberWithSerenity` |
| `StoredFeatureFile` | Uses `CucumberRuntimeOptions` instead of `CucumberWithSerenity` |
| `Main` (CLI) | Uses `CucumberRuntimeOptions` instead of `CucumberWithSerenity` |

## Upgrade

```xml
<dependency>
    <groupId>net.serenity-bdd</groupId>
    <artifactId>serenity-core</artifactId>
    <version>5.3.2</version>
</dependency>
```

No code changes are required. This is a drop-in replacement for 5.3.1.

---

**Full Changelog**: https://github.com/serenity-bdd/serenity-core/compare/5.3.1...5.3.2
