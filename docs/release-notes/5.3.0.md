# Serenity BDD 5.3.0 Release Notes

**String-Based `@Epic`, `@Feature`, `@Story` Annotations for Requirements Hierarchies**

This release introduces Allure-style string-based annotations for organising tests into a three-level requirements hierarchy (Epic > Feature > Story), adds `@DisplayName` as the default story name when `@Story` is absent, and includes a new `@Epic` annotation. This is a minor version bump because the `@Story` annotation has a **breaking change** — see the migration guide below.

## Breaking Changes

### `@Story` Annotation Signature Changed

The `@Story` annotation's `value()` attribute has changed from `Class<?>` to `String`. If you use the legacy class-based `@Story` annotation, you must update your code.

**Before (5.2.x):**
```java
@Story(MyApp.PurchaseItem.class)
public class WhenPurchasingAnItem { }
```

**After (5.3.0):**
```java
@Story(storyClass = MyApp.PurchaseItem.class)
public class WhenPurchasingAnItem { }
```

This is a mechanical find-and-replace: change `@Story(SomeClass.class)` to `@Story(storyClass = SomeClass.class)`.

**Who is affected?** Only users who use the class-based `@Feature`/`@Story` hierarchy pattern with inner marker classes. If you don't use `@Story` annotations at all, or use Cucumber features for requirements, this change does not affect you.

## What's New

### String-Based Requirements Annotations

You can now define a three-level requirements hierarchy using simple string annotations — no boilerplate marker classes needed:

```java
@Epic("E-commerce Platform")
@Feature("Shopping Cart")
@Story("Add item to cart")
public class WhenAddingItemsToCart {
    // tests...
}
```

This produces a requirements tree in the Living Documentation report:

```
E-commerce Platform
  └── Shopping Cart
        └── Add item to cart
```

#### The Annotations

| Annotation | Level | Purpose |
|-----------|-------|---------|
| `@Epic("name")` | Top | Groups related features into a business epic |
| `@Feature("name")` | Middle | Groups related stories into a feature |
| `@Story("name")` | Bottom | Names the user story tested by this class |

All three annotations live in `net.serenitybdd.annotations` and can be applied to both classes and methods.

#### Partial Hierarchies

You don't need all three levels. Use whatever makes sense for your project:

```java
// Just Feature + Story (most common)
@Feature("User Authentication")
@Story("Login with valid credentials")
public class WhenLoggingIn { }

// Just Feature (story name comes from @DisplayName or class name)
@Feature("User Authentication")
@DisplayName("Login with valid credentials")
public class WhenLoggingIn { }

// Just Story
@Story("Add item to cart")
public class WhenAddingItems { }
```

#### Superclass Inheritance

Annotations on superclasses are inherited, so you can define shared context in a base class:

```java
@Epic("E-commerce Platform")
@Feature("Shopping Cart")
public abstract class ShoppingCartTestBase { }

@Story("Add item to cart")
public class WhenAddingItems extends ShoppingCartTestBase { }

@Story("Remove item from cart")
public class WhenRemovingItems extends ShoppingCartTestBase { }
```

### `@DisplayName` as Default Story Name

When a test class has `@Feature` or `@Epic` but no `@Story` annotation, the JUnit 5 `@DisplayName` value is now used as the story name. This avoids the need for a separate `@Story` annotation when the display name already describes the story:

```java
@Feature("Managing Todos")
@DisplayName("Complete todo items")
public class WhenCompletingTodosTest {
    // Story name in the report: "Complete todo items"
    // Requirements path: Managing Todos > Complete todo items
}
```

If neither `@Story` nor `@DisplayName` is present, the humanised class name is used as before.

### New `@Epic` Annotation

The new `@Epic` annotation (`net.serenitybdd.annotations.Epic`) introduces a top-level grouping above `@Feature`:

```java
@Epic("E-commerce Platform")
@Feature("Shopping Cart")
@Story("Add item to cart")
public class WhenAddingItems { }
```

Epics appear as the top level in the Living Documentation requirements hierarchy and generate `epic:name` tags in the Serenity reports.

### Tags from Annotations

All three annotations automatically generate Serenity tags:

- `@Epic("E-commerce")` generates tag `epic:E-commerce`
- `@Feature("Shopping Cart")` generates tag `feature:Shopping Cart`
- `@Story("Add item")` generates tag `story:Add item`

These tags can be used for filtering in the Serenity reports, just like `@WithTag` annotations.

## Migration Guide

### Step 1: Update `@Story` Class References

Find all usages of `@Story(SomeClass.class)` and change to `@Story(storyClass = SomeClass.class)`:

```bash
# Find affected files
grep -rn '@Story(' --include='*.java' | grep '\.class)'
```

**Before:**
```java
@Story(Application.PurchaseItem.class)
```

**After:**
```java
@Story(storyClass = Application.PurchaseItem.class)
```

### Step 2 (Optional): Migrate to String-Based Annotations

If you want to take advantage of the new string-based annotations, you can replace the class hierarchy approach entirely:

**Before:**
```java
public class Application {
    @Feature
    public class Shopping {
        public class PurchaseItem {}
        public class BrowseCatalog {}
    }
}

@Story(Application.Shopping.PurchaseItem.class)
public class WhenPurchasingAnItem { }
```

**After:**
```java
@Feature("Shopping")
@Story("Purchase item")
public class WhenPurchasingAnItem { }
```

This is optional — the legacy class-based approach continues to work with `storyClass`.

### Step 3: Update Dependencies

```xml
<dependency>
    <groupId>net.serenity-bdd</groupId>
    <artifactId>serenity-core</artifactId>
    <version>5.3.0</version>
</dependency>
```

## Documentation

- [Annotation-Based Requirements](https://serenity-bdd.github.io/docs/guide/annotation-requirements) — comprehensive guide with examples
- [Living Documentation](https://serenity-bdd.github.io/docs/reporting/living-documentation) — how annotations appear in reports
- [JUnit 5 Tests](https://serenity-bdd.github.io/docs/junit5/junit5-tests) — organising tests with `@Feature` and `@Story`

---

**Full Changelog**: https://github.com/serenity-bdd/serenity-core/compare/5.2.4...5.3.0
